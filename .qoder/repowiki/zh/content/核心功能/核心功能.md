# 核心功能

<cite>
**本文档中引用的文件**  
- [request.ts](file://packages/web-lite/src/stores/request.ts)
- [environment.ts](file://packages/web-lite/src/stores/environment.ts)
- [history.ts](file://packages/web-lite/src/stores/history.ts)
- [collection.ts](file://packages/web-full/src/stores/collection.ts)
- [automation.ts](file://packages/web-pro/src/stores/automation.ts)
- [documentation.ts](file://packages/web-pro/src/stores/documentation.ts)
- [mock.ts](file://packages/web-pro/src/stores/mock.ts)
- [index.ts](file://packages/shared/types/index.ts)
</cite>

## 目录
1. [基础API调试](#基础api调试)
2. [环境管理](#环境管理)
3. [历史记录](#历史记录)
4. [接口集合管理](#接口集合管理)
5. [批量测试](#批量测试)
6. [团队协作](#团队协作)
7. [自动化测试](#自动化测试)
8. [性能测试](#性能测试)
9. [API文档生成](#api文档生成)
10. [Mock服务](#mock服务)

## 基础API调试

基础API调试功能是工具的核心入口，提供轻量级的请求构建、发送与响应查看能力。用户可通过表单配置HTTP方法、URL、请求头、参数、认证方式和请求体，并实时查看响应状态、耗时、大小、响应头与响应体。支持环境变量自动解析，允许用户在URL、请求头和参数中使用`{{variable}}`或`${variable}`语法引用环境变量。

该功能主要由`request.ts`状态管理模块驱动，通过`useRequestStore`管理当前请求配置、响应数据、加载状态和错误信息。`sendRequest`方法负责构建实际的fetch请求，处理认证逻辑（Bearer Token、Basic Auth、API Key），并记录成功请求至历史记录。`resolvedRequest`计算属性自动解析环境变量，确保请求配置的动态性。

**本功能模块适用于web-lite和web-full版本，是所有高级功能的基础。**

**功能用途**：快速调试单个API接口，验证请求参数和响应结果。

**实现方式**：
- 使用Pinia管理请求状态
- 通过fetch API执行HTTP请求
- 支持多种认证方式
- 自动解析环境变量
- 响应数据格式化显示

**用户交互逻辑**：
1. 用户在请求面板填写URL、选择方法
2. 配置请求头、查询参数和请求体
3. 点击"发送"按钮触发`sendRequest`
4. 显示加载状态，等待响应
5. 响应返回后，展示响应详情
6. 成功请求自动保存至历史记录

**主要组件**：
- [RequestPanel.vue](file://packages/web-lite/src/components/RequestPanel.vue)

**状态管理文件**：
- [request.ts](file://packages/web-lite/src/stores/request.ts)

## 环境管理

环境管理功能允许用户创建、编辑和切换不同的环境配置，每个环境包含一组变量（如`baseUrl`、`apiKey`等），用于在不同部署环境（开发、测试、生产）间快速切换。支持环境变量的继承与覆盖机制，全局变量可被所有环境共享，当前激活环境的变量优先级最高。

该功能由`environment.ts`状态管理模块实现，通过`useEnvironmentStore`管理环境列表、当前环境ID、全局变量和活动变量。`createEnvironment`、`updateEnvironment`、`deleteEnvironment`等方法提供完整的CRUD操作。`resolveVariables`方法负责解析文本中的变量引用，支持`{{}}`和`${}`两种语法。环境配置可导出为JSON格式，支持合并导入或完全替换。

**功能用途**：管理不同部署环境的配置变量，避免手动修改请求配置。

**实现方式**：
- 环境变量存储在localStorage
- 支持变量引用解析
- 提供环境复制、导入导出功能
- 实现变量冲突检测

**用户交互逻辑**：
1. 用户在环境管理页面创建新环境
2. 为环境添加变量（如baseUrl、apiKey）
3. 通过下拉菜单切换当前环境
4. 在请求中使用`{{baseUrl}}`引用变量
5. 切换环境后，所有引用自动更新

**主要组件**：
- [EnvironmentDialog.vue](file://packages/web-lite/src/components/EnvironmentDialog.vue)
- [Environments.vue](file://packages/web-lite/src/views/Environments.vue)

**状态管理文件**：
- [environment.ts](file://packages/web-lite/src/stores/environment.ts)

## 历史记录

历史记录功能自动保存用户执行过的API请求，便于快速复用和审计。支持按名称、URL、方法搜索，可按收藏、方法类型过滤，支持收藏重要请求、添加标签、重命名和清空记录。历史记录按时间倒序排列，最近的请求优先显示。

该功能由`history.ts`状态管理模块实现，通过`useHistoryStore`管理历史记录列表、搜索条件和过滤状态。`addItem`方法在请求成功后被调用，将请求配置和响应数据保存为历史记录项。`removeItem`、`toggleFavorite`、`updateItemName`等方法提供完整的管理功能。历史记录支持导出为JSON格式，可导入到其他实例。

**功能用途**：追踪API调用历史，快速复用常用请求。

**实现方式**：
- 本地存储历史记录
- 提供搜索和过滤功能
- 支持收藏和标签管理
- 限制最大记录数量

**用户交互逻辑**：
1. 用户发送API请求
2. 成功请求自动添加到历史记录
3. 用户可在历史记录面板查看所有请求
4. 可搜索、过滤、收藏或重命名记录
5. 点击历史记录可加载到请求面板重新执行

**主要组件**：
- [HistoryPanel.vue](file://packages/web-lite/src/components/HistoryPanel.vue)
- [History.vue](file://packages/web-lite/src/views/History.vue)

**状态管理文件**：
- [history.ts](file://packages/web-lite/src/stores/history.ts)

## 接口集合管理

接口集合管理功能提供结构化的API组织方式，支持创建包含文件夹和请求的集合。用户可对集合进行增删改查、复制、导入（Postman、OpenAPI）和导出操作。集合中的请求可被批量执行，支持在集合内快速导航和搜索。

该功能由`collection.ts`状态管理模块实现，通过`useCollectionStore`管理集合列表、当前集合、请求历史和测试结果。`createCollection`、`updateCollection`、`deleteCollection`等方法提供集合管理功能。`createRequest`、`updateRequest`、`deleteRequest`等方法管理集合内的请求。`importCollection`和`exportCollection`支持与其他工具的互操作。

**功能用途**：组织和管理大量API接口，形成可复用的测试套件。

**实现方式**：
- 树形结构组织请求
- 支持导入导出标准格式
- 提供集合级别的操作
- 与历史记录和批量测试集成

**用户交互逻辑**：
1. 用户创建新的API集合
2. 在集合中添加文件夹和请求
3. 编辑请求配置，保存到集合
4. 可导入Postman或OpenAPI定义
5. 导出集合供团队共享

**主要组件**：
- [CollectionDialog.vue](file://packages/web-full/src/components/CollectionDialog.vue)
- [CollectionTree.vue](file://packages/web-full/src/components/CollectionTree.vue)
- [CollectionManagement.vue](file://packages/web-full/src/pages/CollectionManagement.vue)

**状态管理文件**：
- [collection.ts](file://packages/web-full/src/stores/collection.ts)

## 批量测试

批量测试功能允许用户选择集合中的多个请求进行连续执行，验证API的批量行为。执行结果以汇总报告形式展示，包括总请求数、通过数、失败数和总耗时。每个请求的执行结果独立记录，便于定位问题。

该功能由`collection.ts`中的`runBatchTest`方法实现，遍历指定的请求列表，依次调用`executeRequest`执行每个请求。成功请求记录为通过，捕获到异常的请求记录为失败。结果汇总后通过Element Plus的`ElMessage`组件展示成功提示。

**功能用途**：批量执行多个API请求，验证集成场景。

**实现方式**：
- 顺序执行请求列表
- 捕获每个请求的异常
- 统计通过/失败数量
- 展示执行摘要

**用户交互逻辑**：
1. 用户在集合管理页面选择多个请求
2. 点击"批量测试"按钮
3. 系统依次执行选中的请求
4. 显示批量测试结果摘要
5. 用户可查看每个请求的详细结果

**主要组件**：
- [BatchTest.vue](file://packages/web-full/src/pages/BatchTest.vue)
- [BatchTestDetail.vue](file://packages/web-full/src/pages/BatchTestDetail.vue)

**状态管理文件**：
- [collection.ts](file://packages/web-full/src/stores/collection.ts)

## 团队协作

团队协作功能支持多用户协同工作，提供团队成员管理、权限控制、活动日志和通知系统。管理员可邀请成员、分配角色（管理员、编辑者、查看者）、设置访问权限。所有操作记录在活动日志中，便于审计和追踪变更。

该功能由`team.ts`状态管理模块实现，管理团队成员列表、角色权限和活动日志。`createTeam`、`inviteMember`、`updateMemberRole`等方法提供团队管理功能。`logActivity`方法记录所有关键操作，形成完整的审计追踪。

**功能用途**：支持多用户协作开发和测试API。

**实现方式**：
- 基于角色的访问控制
- 活动日志记录
- 成员邀请和权限管理
- 团队设置和通知

**用户交互逻辑**：
1. 团队管理员邀请新成员
2. 设置成员角色和权限
3. 成员登录后根据权限访问资源
4. 所有操作记录在活动日志
5. 通过通知系统接收重要事件

**主要组件**：
- [TeamManagement.vue](file://packages/web-full/src/pages/TeamManagement.vue)
- [Team.vue](file://packages/web-pro/src/pages/Team.vue)

**状态管理文件**：
- [team.ts](file://packages/web-full/src/stores/team.ts)

## 自动化测试

自动化测试功能提供完整的测试套件管理，支持创建包含多个测试用例的测试套件，配置执行环境、超时、重试次数和并发数。支持断言配置（状态码、响应头、响应体、响应时间），可设置测试通过/失败的条件。支持定时调度和结果通知。

该功能由`automation.ts`状态管理模块实现，通过`useAutomationStore`管理测试套件、测试结果、调度计划和设置。`createSuite`、`updateSuite`、`deleteSuite`方法管理测试套件。`runSuite`、`runAllSuites`方法执行测试。`TestSuite`接口定义了测试套件的完整配置，包括断言规则和通知设置。

**功能用途**：创建可重复执行的自动化测试，确保API稳定性。

**实现方式**：
- 测试套件包含多个测试用例
- 支持多种断言类型
- 可配置执行策略
- 支持定时运行和结果通知

**用户交互逻辑**：
1. 用户创建新的测试套件
2. 添加测试用例，配置请求和断言
3. 设置测试环境和执行参数
4. 手动或定时运行测试套件
5. 查看详细的测试结果报告

**主要组件**：
- [Automation.vue](file://packages/web-pro/src/views/Automation.vue)
- [CreateSuiteDialog.vue](file://packages/web-pro/src/components/automation/CreateSuiteDialog.vue)

**状态管理文件**：
- [automation.ts](file://packages/web-pro/src/stores/automation.ts)

## 性能测试

性能测试功能用于评估API在高负载下的表现，支持并发请求、压力测试和性能监控。可配置并发用户数、请求速率和测试时长，收集响应时间、吞吐量、错误率等关键指标。提供丰富的可视化图表，包括响应时间分布、请求量趋势和错误分析。

该功能由`performance.ts`状态管理模块实现，管理性能测试配置、指标收集和报告生成。`PerformanceMetrics`接口定义了性能监控的详细指标，包括DNS解析、TCP连接、TLS握手、首字节时间等。`PerformanceReport`接口定义了性能报告的结构，包含统计摘要和原始指标数据。

**功能用途**：评估API的性能瓶颈和稳定性。

**实现方式**：
- 并发执行多个请求
- 收集详细的性能指标
- 生成性能报告
- 提供可视化分析

**用户交互逻辑**：
1. 用户配置性能测试参数
2. 设置并发数和测试时长
3. 启动性能测试
4. 实时查看性能指标
5. 生成性能报告进行分析

**主要组件**：
- [Performance.vue](file://packages/web-pro/src/views/Performance.vue)
- [PerformanceSettingsDialog.vue](file://packages/web-pro/src/components/performance/PerformanceSettingsDialog.vue)

**状态管理文件**：
- [performance.ts](file://packages/web-pro/src/stores/performance.ts)

## API文档生成

API文档生成功能允许用户创建和管理交互式API文档，支持从API集合导入端点，或手动创建文档。文档支持Markdown内容、代码示例和交互式试用。可配置文档主题、布局和发布设置，生成美观的静态文档站点。

该功能由`documentation.ts`状态管理模块实现，通过`useDocumentationStore`管理文档列表、当前文档和主题设置。`createDocumentation`、`updateDocumentation`、`deleteDocumentation`方法管理文档生命周期。`addEndpoint`、`updateEndpoint`方法管理API端点。`ApiEndpoint`接口定义了端点的完整结构，包括参数、请求体、响应和示例。

**功能用途**：创建和发布API文档，便于开发者使用。

**实现方式**：
- 结构化文档组织
- 支持OpenAPI风格的端点定义
- 可配置文档主题
- 支持发布和分享

**用户交互逻辑**：
1. 用户创建新的API文档
2. 添加文档章节和API端点
3. 配置端点的参数、请求体和响应
4. 添加代码示例和描述
5. 发布文档并分享链接

**主要组件**：
- [Documentation.vue](file://packages/web-pro/src/views/Documentation.vue)
- [ApiDocTree.vue](file://packages/web-pro/src/components/documentation/ApiDocTree.vue)

**状态管理文件**：
- [documentation.ts](file://packages/web-pro/src/stores/documentation.ts)

## Mock服务

Mock服务功能允许用户创建虚拟的API端点，返回预定义的响应。支持配置请求方法、路径、响应状态码、响应头和响应体。可设置响应延迟，模拟网络延迟。支持条件匹配，根据请求头、查询参数或请求体返回不同响应。

该功能由`mock.ts`状态管理模块实现，通过`useMockStore`管理Mock路由、服务器设置和请求日志。`createRoute`、`updateRoute`、`deleteRoute`方法管理Mock路由。`startServer`、`stopServer`方法控制Mock服务器。`matchRoute`方法根据请求匹配最合适的Mock路由。

**功能用途**：在后端API未完成时，提供前端开发所需的模拟数据。

**实现方式**：
- 基于路径和方法的路由匹配
- 支持条件化响应
- 可配置响应延迟
- 提供请求日志

**用户交互逻辑**：
1. 用户创建新的Mock路由
2. 配置请求方法和路径
3. 设置响应状态码和响应体
4. 启动Mock服务器
5. 前端应用调用Mock API获取模拟数据

**主要组件**：
- [MockServer.vue](file://packages/web-pro/src/views/MockServer.vue)
- [MockRoute](file://packages/web-pro/src/types/index.ts#L298-L358)

**状态管理文件**：
- [mock.ts](file://packages/web-pro/src/stores/mock.ts)